---
title: "Bike Share Case Study - 4 - Summary of Findings"
output: html_notebook
---

```{r echo= FALSE, results = "hide", message = FALSE, warning = FALSE}

knitr::opts_chunk$set(
  fig.width = 8, 
  fig.asp = 0.618, 
  fig.align = "center", 
  out.width = "100%"
)

library(tidyverse)
library(lubridate)
library(gridExtra) 

bike_share_files <- list.files(
                      path = "2 Extracted Data", 
                      pattern = '*.csv',   
                      full.names = TRUE
                    )

column_types <- cols(rideable_type = col_factor(), member_casual = col_factor())

bike_share <- map_dfr(bike_share_files, read_csv, col_types = column_types)

bike_share <- bike_share %>%
  mutate(
    start_quarter = quarter(started_at),
    start_month   = factor(month(started_at, label = TRUE)),
    start_week    = week(started_at),
    start_wday    = factor(wday(started_at, label = TRUE)),
    start_mday    = mday(started_at),
    start_hour    = hour(started_at),
    ride_duration = as.duration(interval(start = started_at, end = ended_at))
  )

bike_share$start_wday <- fct_relevel(bike_share$start_wday, "Sun", after = 6)

bike_share <- bike_share %>% 
  mutate(
    ride_displacement = sqrt((end_lat - start_lat)^2 + (end_lng - start_lng)^2)
  )

bike_share <- bike_share %>%
  mutate(ride_duration = ifelse(
                           ride_duration < 0 & start_month == "Nov",
                           ride_duration + 3600,
                           ride_duration
                         )
  )

bike_share <- bike_share %>%
  filter(ride_duration >= 0) 

rides_to_add_3600 <- 
  bike_share$started_at < ymd_hms("2021-11-07 01:00:00") & 
  bike_share$ended_at >= ymd_hms("2021-11-07 02:00:00")

bike_share <- bike_share %>%
  mutate(ride_duration = ifelse(
                           rides_to_add_3600,
                           ride_duration + 3600,
                           ride_duration
                         )
  )

rides_to_subtract_3600 <- 
  bike_share$started_at < ymd_hms("2021-03-14 02:00:00") &
  bike_share$ended_at >= ymd_hms("2021-03-14 03:00:00") 

bike_share <- bike_share %>%
  mutate(ride_duration = ifelse(
                           rides_to_subtract_3600,
                           ride_duration - 3600,
                           ride_duration
                         )
  )

bike_share <- bike_share %>%  
  mutate(start_station_name = 
           ifelse(
             is.na(start_station_name) & start_station_id == "13221",
             "Wood St & Milwaukee Ave",
             start_station_name
           )
  ) %>%
  mutate(end_station_name = 
           ifelse(
             is.na(end_station_name) & end_station_id == "13221",
             "Wood St & Milwaukee Ave",
             end_station_name
           )
  ) %>%
  mutate(start_station_name = 
           ifelse(
             is.na(start_station_name) & start_station_id == "20215",
             "Hegewisch Metra Station",
             start_station_name
           )
  ) %>%
  mutate(end_station_name = 
           ifelse(
             is.na(end_station_name) & end_station_id == "20215",
             "Hegewisch Metra Station",
             end_station_name
           )
  ) %>%
  mutate(start_station_name = 
           ifelse(
             is.na(start_station_name) & start_station_id == "WL-008",
             "Clinton St & Roosevelt Rd",
             start_station_name
           )
  ) %>%
  mutate(end_station_name = 
           ifelse(
             is.na(end_station_name) & end_station_id == "WL-008",
             "Clinton St & Roosevelt Rd",
             end_station_name
           )
  )

loomis <- "Loomis St & 89th St"

bike_share <- bike_share %>%
  mutate(start_station_id = 
           ifelse(
             start_station_name == loomis & start_station_id == "201022",
             "20102",
             start_station_id
           )
  ) %>%
  mutate(end_station_id = 
           ifelse(
             end_station_name == loomis & end_station_id == "201022",
             "20102",
             end_station_id
           )
  )

test_station <- "Hubbard Bike-checking (LBS-WH-TEST)"

bike_share <- bike_share %>%
  filter(start_station_id != test_station | is.na(start_station_id)) %>%
  filter(end_station_id   != test_station | is.na(end_station_id))

bike_share <- bike_share %>%
  filter(end_lng >= -88.5 | is.na(end_lng))

bike_coord <- coord_quickmap(xlim = c(-87.83, -87.52), ylim = c(41.65, 42.07))

bike_share <- bike_share %>%
  mutate(wkend = factor(
                   ifelse(start_wday %in% c("Sat", "Sun"), "Weekend", "Weekday")
                 )
  )

bike_share <- bike_share %>%
  mutate(
    lat = round(start_lat, 2), 
    lng = round(start_lng, 2)
  )

bike_share$member_casual <- fct_recode(
                              bike_share$member_casual,
                              "Members" = "member", 
                              "Casual Riders" = "casual"
                            )
  
bike_share$rideable_type <- fct_recode(
                              bike_share$rideable_type,
                              "Electric" = "electric_bike",
                              "Classic" = "classic_bike",
                              "Docked" = "docked_bike"
                            )

bike_share$wkend <- fct_recode(
                      bike_share$wkend,
                      "Weekdays" = "Weekday",
                      "Weekends" = "Weekend"
                    )

bike_share$start_quarter <- 
  factor(
    bike_share$start_quarter, 
    levels = 1:4,
    labels = str_c(c("First", "Second", "Third", "Fourth"), " Quarter")
  )
     
nrow(bike_share)  # should be 5594092
```

# Business task

  This case study is being done as part to the coursework for the [Google Data Analytics Professional Certificate](https://www.coursera.org/professional-certificates/google-data-analytics).  The case study is for Cyclistic, a fictional bike-share company in Chicago.  Cyclistic customers who purchase annual memberships are referred to a members, and customers who purchase single-ride or full-day passes are referred to as casual riders.  
  
  Cyclistic's marketing manager believes that maximizing the number of annual members will be a key to future growth.  The goal of this case study was to identify differences in bike usage between members and casual riders, with an eye to developing a strategy to convert casual riders to members.
  


# Data sources
  
  The data was made available by Motivate International Inc. under this [license](https://ride.divvybikes.com/data-license-agreement), and can be found
[here](https://divvy-tripdata.s3.amazonaws.com/index.html).

  The data is public and does not contain any identifiable customer information, so there are no security or privacy concerns to address.
  
  These are the data files that were used:
  
* 202101-divvy-tripdata.zip
* 202102-divvy-tripdata.zip
* 202103-divvy-tripdata.zip
* 202104-divvy-tripdata.zip
* 202105-divvy-tripdata.zip
* 202106-divvy-tripdata.zip
* 202107-divvy-tripdata.zip
* 202108-divvy-tripdata.zip
* 202109-divvy-tripdata.zip
* 202110-divvy-tripdata.zip
* 202111-divvy-tripdata.zip
* 202112-divvy-tripdata.zip

The data consists of 12 monthly CSV files of bike share data for the year 2021.  Visual inspection of the files showed there were 13 columns per file, and the column names were consistent across all files.  The number of records in the 12 files totaled to 5,595,063.

The data includes:

* Ride ID
* Type of bike
* Start and end datetimes for the ride
* Names and IDs of the stations at which the ride started and ended
* Latitude and longitude where the ride started and ended
* Whether the user was a member or a casual rider


# Quick Summary

The most significant differences between members and casual riders are centered around three aspects of the rides:

* The time the ride occurs, such as the month, the hour of the day, or the day of the week

* The type of bike that is used for the ride

* The length of time the ride lasts
  


# Differences in the Time the Ride Occurs


In 2021 there were about 3 million rides by members, and about 2.5 million rides by casual riders, as shown in the chart below.

```{r echo= FALSE}
bike_share %>%
  group_by(member_casual) %>%
  summarize(count = n(), .groups = "keep") %>%
  ggplot(mapping = aes(x = member_casual, y = count)) +
  geom_col(mapping = aes(fill = member_casual), width = 0.5) +
  scale_y_continuous(
    breaks = 0:7 * 500000, 
    labels = c("0.0M", "0.5M", "1.0M", "1.5M", "2.0M", "2.5M", "3.0M", "3.5M")       
  ) +
  coord_cartesian(ylim = c(0, 3500000)) +
  labs(
    title = "2021 Total Ride Counts by Members and Casual Riders",
    x = "",
    y = "Count of Rides in Millions"
  ) +
  geom_text(
    mapping = aes(label = format(count, big.mark=",", scientific=FALSE)), 
    vjust = -0.5
  ) +
  theme(legend.position = "none")
```

The chart below shows monthly counts of rides for members and for casual riders.  The chart shows that the use of bikes is seasonal, with bike use highest in the warmer months and lowest in the colder months. This is true for both members and casual riders, but the seasonal effect is more pronounced among the casual riders.

```{r echo= FALSE}
bike_share %>%
  ggplot(mapping = aes(x = start_month)) +
  geom_bar(
    mapping = aes(fill = member_casual), 
    position = "dodge", 
    width = 0.7
  ) +
  scale_y_continuous(
    breaks = 0:4 * 100000,
    labels = c("0K", "100K", "200K", "300K", "400K")
  ) +
  labs(
    title = "2021 Monthy Ride Counts for Members and Casual Riders",
    x = "",
    y = "Count of Rides",
    fill = "Rider Type"
  ) +
  theme(legend.position = "bottom")
```

The chart below shows the same data in another way.  It shows the percentages of rides by members and by casual riders for each month.  From May to September there are approximately an equal number of rides by each type of rider, with more rides by casual riders than by members in June, July, and August.  But in the colder months there are two or three times as many rides by members than by casual riders.

```{r echo= FALSE}
bike_share %>% 
  group_by(start_month, member_casual) %>%
  summarize(n = n(), .groups = "keep") %>%
  group_by(start_month) %>%
  mutate(percent = 100 * n / sum(n)) %>%
  ggplot(mapping = aes(x = start_month, y = percent, group = member_casual)) +
  geom_line(mapping = aes(color = member_casual), size = 1) +
  geom_point(mapping = aes(color = member_casual), size = 2) +
  scale_y_continuous(breaks = 0:10 * 10) +
  coord_cartesian(ylim = c(0, 100)) +
  labs(
    title = "Monthly Percentages of Rides by Each Rider Type",
    x = "",
    y = "Percentage of Rides",
    color = "Rider Type:  "
  ) +
  theme(legend.position = "bottom") 
```

The charts below show counts of rides by day of the week for each group of riders.  Ride counts by members don't vary too much by day of the week.  But rides by casual riders increase significantly on weekends, and also somewhat on Fridays.  This pattern for casual users holds in all parts of the year.

```{r echo= FALSE}
bike_share %>%
  ggplot(mapping = aes(x = start_wday)) +
  geom_bar(mapping = aes(fill = member_casual)) +
  scale_y_continuous(
    breaks = 0:6 * 100000, 
    labels = c("0K", "100K", "200K", "300K", "400K", "500K", "600K")
  ) +
  coord_cartesian(ylim = c(0, 600000)) +
  facet_wrap(~ member_casual) +
  labs(
    title = "Ride Counts by Day of the Week",
    subtitle = "Members vs. Casual Riders",
    x = "",
    y = "Count of Rides",
    fill = "Rider Type:  "
  ) +
  theme(legend.position = "bottom") 
```

The charts below show the percentages of rides by members and by casual riders that occurred on weekdays and on weekends, broken down by month.  

In all months of the year the rides by members on weekdays outnumber those by casual riders, although in the months of June through August the two groups have nearly the same amount of rides on weekdays. 

But on weekends, the rides by casual riders outnumber those by members from April to October.

```{r echo= FALSE}
 bike_share %>%
  group_by(start_month, wkend, member_casual) %>%
  summarize(n = n(), .groups = "keep") %>%
  group_by(start_month, wkend) %>%
  mutate(percent = 100 * n / sum(n)) %>%
  ggplot(mapping = aes(x = start_month, y = percent, group = member_casual)) +
  geom_line(mapping = aes(color = member_casual), size = 1) +
  geom_point(mapping = aes(color = member_casual), size = 1.5) +
  scale_y_continuous(breaks = 0:10 * 10) +
  coord_cartesian(ylim = c(0, 100)) +
  facet_wrap(~ wkend) +
  labs(
    title = "Monthly Percentages of Rides by Each Rider Type",
    subtitle = "Weekdays vs. Weekends",
    x = "",
    y = "Percentage of Rides",
    color = "Rider Type:  "
  ) +
  theme(legend.position = "bottom") 
```

The charts below show the distribution of rides throughout the hours of the day for the two types of riders, on both weekdays on weekends.  

On weekdays the most significant difference between the two groups is a sharp increase in rides by members centered around 7:00 to 9:00 in the morning.  Rides by casual users don't show such a marked increase in that time period.  For both groups peak usage is in the late afternoon and early evening.

On weekends, the distributions by hour of the day are very similar for both rider types.  The distributions are smoother, with a wide peak between noon and 4 p.m. 

These patterns hold in all parts of the year.

```{r echo= FALSE}
 bike_share %>%
  group_by(wkend, start_hour, member_casual) %>%
  summarize(n = n(), .groups = "keep") %>%
  group_by(wkend, member_casual) %>%
  mutate(percent = 100 * n / sum(n)) %>%
  ggplot(mapping = aes(x = start_hour, y = percent)) +
  geom_line(mapping = aes(color = member_casual), size = 1) +
  geom_point(mapping = aes(color = member_casual), size = 1.5) +
  scale_x_continuous(
    breaks = seq(from = 2, to = 22, by = 4),  
    labels = c("2am", "6am", "10am", "2pm", "6pm", "10pm")
  ) +
  facet_wrap(~ wkend) +
  labs(
    title = "Hourly Distribution of Rides for Each Rider Type",
    subtitle = "Weekdays vs. Weekends",
    x = "",
    y = "Percentage of Rides",
    color = "Rider Type:  "
  ) +
  theme(legend.position = "bottom") 
```


# Differences in Type of Bike Used for the Ride


The charts below show the percentages of rides for each type of bike for the two groups of riders.

Overall, both groups used classic bikes the majority of the time.  

Members used classic bikes nearly twice as often as electric bikes, and there was only one ride by a member on a docked bike in 2021.

Casual riders used classic bikes about half of the time, and they used electric bikes about 38% of the time, which agrees with the percentage of electric bike use by members.  About 12% of the time casual riders used docked bikes.

```{r echo= FALSE}
bike_share %>%
  group_by(member_casual, rideable_type) %>%
  summarize(n = n(), .groups = "keep") %>%
  group_by(member_casual) %>%
  mutate(
    percent = 100 * n / sum(n),
    label = paste(as.character(round(percent, 1)), "%", sep = ""),
  ) %>%
  ggplot(mapping = aes(x = rideable_type, y = percent)) +
  geom_col(mapping = aes(fill = rideable_type)) +
  scale_y_continuous(breaks = 0:10 * 10) +
  scale_fill_viridis_d(option = "plasma", end = 0.8, drop = FALSE) +
  coord_cartesian(ylim = c(0, 100)) +
  facet_wrap(~ member_casual) +
  labs(
    title = "Choice of Bike Type",
    subtitle = "Members vs. Casual Riders",
    x = "",
    y = "Percentage of Rides", 
    fill = "Bike Type"
  ) +
  geom_text(mapping = aes(label = label), vjust = -0.5) +
  theme(legend.position = "bottom")
```

The chart below shows the monthly percentages of rides by members for each bike type. 

The relative percentages of rides on electric and classic bikes are stable until the last three months of the year, during which the percentage of rides on electric bikes increases and overtakes that of rides on classic bikes.

```{r echo= FALSE}
bike_share %>%
  filter(member_casual == "Members") %>%
  group_by(rideable_type, start_month) %>%
  summarize(ride_count = n(), .groups = "keep") %>%
  group_by(start_month) %>%
  mutate(percent = 100 * ride_count / sum(ride_count)) %>%
  ggplot(mapping = aes(x = start_month, y = percent, group = rideable_type)) +
  geom_line(mapping = aes(color = rideable_type), size = 1) +
  geom_point(mapping = aes(color = rideable_type), size = 2) +
  scale_y_continuous(breaks = 0:10 * 10) +
  scale_color_viridis_d(option = "plasma", end = 0.8, drop = FALSE) +
  coord_cartesian(ylim = c(0, 100)) +
  labs(
    title = "Choice of Bike Type by Members",
    x = "",
    y = "Percentage of Rides",
    color = "Bike Type"
  ) +
  theme(legend.position = "bottom") 
```

The chart below shows the monthly percentages of rides by casual riders for each bike type. 

Casual riders show more variability in choice of bike type in the first nine months of the year, but starting in October there's the same shift from classic to electric bikes that was seen among rides by members. 

From March to December there's also a gradual decrease in the percentage of rides on docked bikes.  

These changes in use of bike types could be due to a change in the availability of the different bike types, or in the cost of rides on different types of bikes.  More information than what's in the data would be needed to determine why these changes in use of bike types happened.

```{r echo= FALSE}
bike_share %>%
  filter(member_casual == "Casual Riders") %>%
  group_by(rideable_type, start_month) %>%
  summarize(ride_count = n(), .groups = "keep") %>%
  group_by(start_month) %>%
  mutate(percent = 100 * ride_count / sum(ride_count)) %>%
  ggplot(mapping = aes(x = start_month, y = percent, group = rideable_type)) +
  geom_line(mapping = aes(color = rideable_type), size = 1) +
  geom_point(mapping = aes(color = rideable_type), size = 2) +
  scale_y_continuous(breaks = 0:10 * 10) +
  scale_color_viridis_d(option = "plasma", end = 0.8, drop = FALSE) +
  coord_cartesian(ylim = c(0, 100)) +
  labs(
    title = "Choice of Bike Type by Casual Riders",
    x = "",
    y = "Percentage of Rides",
    color = "Bike Type"
  ) +
  theme(legend.position = "bottom") 
```

The charts below show which types of bikes the two groups of riders chose in each quarter of 2021.  
 
For both groups the percentages are stable in the first three quarters of the year.  In the fourth quarter something changed that caused both groups to increase their use of electric bikes.  For casual users the change led to electric bikes being used for the majority of their rides in the fourth quarter.
 
```{r echo= FALSE}
bike_share %>%
  group_by(start_quarter, member_casual, rideable_type) %>%
  summarize(n = n(), .groups = "keep") %>%
  group_by(start_quarter, member_casual) %>%
  mutate(
    percent = 100 * n / sum(n),
    label = paste(as.character(round(percent, 1)), "%", sep = ""),
  ) %>%
  ggplot(mapping = aes(x = rideable_type, y = percent)) +
  geom_col(mapping = aes(fill = rideable_type)) +
  scale_y_continuous(breaks = 0:2 * 50) +
  scale_fill_viridis_d(option = "plasma", end = 0.8, drop = FALSE) +
  coord_cartesian(ylim = c(0, 100)) +
  facet_grid(member_casual ~ start_quarter, switch = "y") +
  labs(
    title = "Quarterly Choice of Bike Type",
    subtitle = "Members vs. Casual Riders",
    x = "",
    y = "Percentage of Rides", 
    fill = "Bike Type"
  ) +
  geom_text(mapping = aes(label = label), vjust = -0.5, size = 3.3) +
  theme(legend.position = "bottom")
```


# Differences in the Length of Time the Ride Lasts


The charts below are box plots for ride duration for members and for casual riders.  There are separate boxes for each type of rider, and for rides on weekdays and on weekends.

The line in the middle of each box represents the median ride duration (in minutes) for that group of rides.  For example, for casual riders on weekends (the box farthest to the right) the median ride duration is about 18 minutes.

The bottom of each box represents the 25th percentile of rides.  For casual riders on weekends, the 25th percentile is about 10 minutes, which means 25% of those rides lasted less than 10 minutes.  The top of the box represents the 75th percentile, which is about 33 minutes for this group of rides.  So 75% of rides lasted less than 33 minutes.  

For casual riders on weekends, a quarter of the rides lasted less than 10 minutes, a quarter lasted 10 to 18 minutes, a quarter lasted 18 to 33 minutes, and a quarter lasted over 33 minutes.  

For both members and casual riders, rides lasted longer on weekends than on weekdays.  But the medians, along with the 25th and 75th percentiles, were longer for casual riders than for members on both weekdays and weekends.  Rides by casual riders tend to be longer in general.

For casual riders there's also a bigger difference between the 25th and 75th percentiles than for members, indicating that there's more variation in ride duration times among casual riders. 

Compared to members, casual riders have median ride times that are about 5 minutes longer on weekdays and about 7 minutes longer on weekends.


```{r echo= FALSE}
bike_share %>%
  ggplot(mapping = aes(x = wkend, y = ride_duration / 60)) +
  geom_boxplot(
    mapping = aes(fill = member_casual), 
    position = "dodge", 
    outlier.shape = NA, 
    coef = 0, 
  ) +
  scale_y_continuous(breaks = 0:17 * 2, sec.axis = dup_axis()) +
  coord_cartesian(ylim = c(0, 35)) +
  facet_wrap(~ member_casual) +
  labs(
    title = "Ride Duration Boxplots, Members vs. Casual Riders",
    subtitle = paste (
                 "Bottom of box = 25th Percentile;  ",
                 "Middle of box = Median;  ", 
                 "Top of box = 75th Percentile"
               ),
    x = "",
    y ="Minutes",
    fill = "Rider Type"
  ) +
  theme(legend.position = "bottom")
```

While these may seem like small differences, they indicate significant differences in use by the two type of riders.  The chart below shows the cumulative distributions of ride duration for both members and casual users.  The solid lines are for weekdays, and the dotted lines are for weekends.

The x-axis is the ride duration in minutes, and the y-axis is the percentage of rides that last less than that number of minutes. 

For example, rides that last less than 15 minutes make up about 40% of rides by casual riders on weekends, and about 50% of their rides on weekdays.  But for members the rides that last less than 15 minutes make up about 60% of their weekend rides, and over 70% of their weekday rides.

```{r echo= FALSE}
bike_share %>% 
  ggplot(mapping = aes(
                     x = ride_duration / 60,  
                     group = interaction(member_casual, wkend)
                   )
  ) +
  stat_ecdf(mapping = aes(color = member_casual, linetype = wkend), size = 1) +
  scale_x_continuous(breaks = 0:12 * 5) +
  scale_y_continuous(breaks = 0:10 / 10, labels = 0:10 * 10) +
  coord_cartesian(xlim = c(0, 60)) +
  labs(
    title = "Ride Duration Cumulative Distributions",
    subtitle = "Members vs. Casual Riders",
    x = "Minutes",
    y = "Percentage of Rides Less Than x Minutes",
    color = "",
    linetype = ""
  ) +
  theme(legend.position = "bottom") +
  geom_vline(xintercept = 15, color = "Gray")
```

Below are ride duration box plots, this time broken down by bike type.

Regardless of bike type, the ride duration medians and 25th and 75th percentiles are always greater for casual users than for members, both on weekdays and weekends. 

And it's also clear that the casual riders use docked bikes to take much longer rides on average than are taken with the electric or classic bikes.  This no doubt contributes to the longer ride times for casual riders in general. But the docked bikes only represent about 12% of the total rides by casual riders, and the chart shows that casual users take longer rides than members do with the electric and classic bikes also.

```{r echo= FALSE}
bike_share %>%
  filter(rideable_type != "Docked" | member_casual != "Members") %>%
  ggplot(mapping = aes(x = wkend, y = ride_duration / 60)) +
  geom_boxplot(
    mapping = aes(fill = rideable_type), 
    position = "dodge", 
    outlier.shape = NA, 
    coef = 0, 
  ) +
  scale_y_continuous(breaks = 0:12 * 5, sec.axis = dup_axis()) +
  scale_fill_viridis_d(option = "plasma", end = 0.8, drop = FALSE) +
  coord_cartesian(ylim = c(0, 60)) +
  facet_wrap(~ member_casual) +
  labs(
    title = "Ride Duration Boxplots, Members vs. Casual Riders, by Bike Type",
    subtitle = paste (
                 "Bottom of box = 25th Percentile;  ",
                 "Middle of box = Median;  ", 
                 "Top of box = 75th Percentile"
               ),
    x = "",
    y ="Minutes",
    fill = "Bike Type"
  ) +
  theme(legend.position = "bottom")
```

The last chart shows how ride duration is related to the hour of the day for both members and casual users.

What's most notable is that the median ride duration doesn't change much for members through the course of the day.  

But for casual users there's more variation depending on the time of day, and on whether it's a weekday or a weekend. Their median ride duration get longest in the early afternoon.

```{r echo= FALSE}
bike_share %>%
  group_by(start_hour, member_casual, wkend) %>%
  summarize(median = median(ride_duration) / 60, .groups = "keep") %>%
  ggplot(mapping = aes(x = start_hour, y = median, group = member_casual)) +
  geom_line(mapping = aes(color = member_casual), size = 1) +
  geom_point(mapping = aes(color = member_casual), size = 1.5) +
  scale_x_continuous(
    breaks = seq(from = 2, to = 22, by = 4),  
    labels = c("2am", "6am", "10am", "2pm", "6pm", "10pm")
  ) +
  coord_cartesian(ylim = c(0, 25)) +
  facet_wrap(~ wkend) +
  labs(
    title = "Hourly Median Ride Duration for Each Rider Type",
    subtitle = "Weekdays vs. Weekends",
    x = "", 
    y = "Minutes",
    color = "Rider Type"
  ) +
  theme(legend.position = "bottom")
```


# Recommendations 

* Casual riders are more likely to ride in the warmer months and on weekends.  Membership plans that last for a few months rather than an entire year could encourage them to become members, as could plans that are restricted to weekend use. It may also be worthwhile to look at demographic data for casual riders to try to determine why they don't have increased numbers of rides in the morning hours as members do.

* There are clear differences in the types of bikes used by the two groups, but more information would be needed to determine the cause of those differences.  Why do only casual riders use docked bikes?  Why did both types of users increase the use of electric bikes at the end of the year?  If the differences are related to the availability of the different bike types to members and to non-members, then it's possible that some changes to that availability could be used to leverage the preferences of casual riders for specific types of bikes.

* There are distinct differences in ride duration between the two groups.  If the members have limits on the duration of their rides, that could be a reason that casual riders, who take longer rides, may not have become members.  It's possible that an extension of ride times for members, perhaps limited to specific days of the week or hours of the day, could make memberships more attractive to casual riders.










